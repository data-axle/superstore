language: ruby
rvm:
- 2.1.10
- 2.2.5
- 2.3.1
sudo: required
dist: trusty
cache: bundler
before_install:
# https://github.com/travis-ci/travis-ci/issues/4264
- sudo cp /etc/postgresql/9.4/main/pg_hba.conf /tmp
- sudo add-apt-repository "deb http://apt.postgresql.org/pub/repos/apt/ $(lsb_release -cs)-pgdg 9.5"
- sudo apt-key adv --keyserver keys.gnupg.net --recv-keys 7FCC7D46ACCC4CF8
- sudo apt-get update
- sudo service postgresql stop
- for version in 9.1 9.2 9.3 9.4; do sudo pg_dropcluster --stop $version main; done
- sudo apt-get remove --purge --yes postgresql-9.[1234]
- sudo apt-get install --no-install-recommends --yes postgresql-client-9.5 postgresql-9.5
- sudo apt-get autoremove --yes
- sudo cp /tmp/pg_hba.conf /etc/postgresql/9.5/main/
- sudo service postgresql restart
- sudo -u postgres createuser -s travis
- sudo -u postgres createdb -O travis travis
